<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>D&D Game</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <header class="header-bar">
    <span class="header-title" id="header-title">D&D Game</span>
    <button id="toggle-dm-panel" class="header-btn" aria-label="–†–µ–∂–∏–º DM">üõ†Ô∏è</button>
  </header>

  <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω -->
  <div id="welcome-screen" class="welcome-screen">
    <div class="welcome-content">
      <h1>D&D Game</h1>
      <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ D&D Game!</p>
      <p>–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –ø–æ–∂–µ–ª–∞–Ω–∏—è –∫ —Å–µ—Ç—Ç–∏–Ω–≥—É –∏ –Ω–∞–∂–º–∏—Ç–µ "–ù–∞—á–∞—Ç—å –∏–≥—Ä—É".</p>
    </div>
  </div>

  <!-- –ò—Å—Ç–æ—Ä–∏—è -->
  <div id="story-container">
    <div id="chat-history" class="chat-history"></div>
  </div>

  <!-- –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ -->
  <div class="character-card-fixed">
    <div class="character-card">
      <!-- –û–±–ª–∞—Å—Ç—å –≤—ã–±–æ—Ä–∞ (–≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç–æ—á–∫–∏, –≤–∏–∑—É–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–∞) -->
      <div class="choices-area">
        <textarea id="init-story-prompt" class="init-story-prompt" placeholder="–ü—Ä–µ–¥—ã—Å—Ç–æ—Ä–∏—è, –ø–æ–∂–µ–ª–∞–Ω–∏—è –ø–æ —Ç–µ–º–∞—Ç–∏–∫–µ, –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ, NPC..." rows="3"></textarea>
        <button id="init-session-main" class="init-session-main-btn" style="display:none">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
        <div class="choices-suggestions" id="choices-suggestions"></div>
        <div class="choices-input-row">
          <div class="input-hero-name" id="input-hero-name" style="display:none">
            <span class="player-icon">üë§</span><span id="char-name-inline">–ì–µ—Ä–æ–π</span>
          </div>
          <input id="choice-input" type="text" placeholder="–í–∞—à–µ –¥–µ–π—Å—Ç–≤–∏–µ..." autocomplete="off">
          <button id="choice-send-btn">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
      </div>
      <div class="card-content-row" id="card-content-row">
        <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ò–º—è –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ (40%) -->
        <div class="stats-column">
          <!-- <div class="player-name-row"><span class="player-icon">üë§</span><span id="char-name">–ì–µ—Ä–æ–π</span></div> -->
          <div class="stats-row-horizontal" id="stats-row-horizontal"></div>
        </div>
        <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –ü—Ä–µ–¥–º–µ—Ç—ã –∏ –Ω–∞–≤—ã–∫–∏ (60%) -->
        <div class="abilities-column">
          <div class="abilities-panel" id="abilities"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- –ë–æ–π -->
  <div class="enemy-overlay" id="enemy-overlay" style="display:none">
    <div class="battle-area" id="battle-area">
      <div class="enemy-box">
        <div class="enemy-name" id="enemy-name"></div>
        <div class="enemy-hp">HP: <span id="enemy-hp"></span></div>
        <div class="status-effects" id="status-effects"></div>
      </div>
    </div>
  </div>

  <!-- –ò—Å—Ç–æ—Ä–∏—è -->
  <!-- –£–¥–∞–ª–µ–Ω–æ: <div id="story-container"><div id="story-text"></div><div id="choices"></div></div> -->

  <!-- DM Overlay –∏ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ -->
  <div class="dm-overlay" id="dm-overlay" style="display:none;">
    <div id="dm-panel" class="dm-modal">
      <div class="api-settings">
        <h4>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ API</h4>
        <input type="text" id="api-key" placeholder="–í–≤–µ–¥–∏—Ç–µ API –∫–ª—é—á OpenRouter" style="width: 100%; padding: 8px; margin-bottom: 10px; background: #2a2a2a; color: #e0e0e0; border: 1px solid #555; border-radius: 4px;">
        <div class="model-selection">
          <label for="model-input" style="display: block; margin-bottom: 5px; color: #ccc;">–ú–æ–¥–µ–ª—å:</label>
          <input type="text" id="model-input" placeholder="deepseek/deepseek-chat-v3.1:free" style="width: 100%; padding: 8px; margin-bottom: 10px; background: #2a2a2a; color: #e0e0e0; border: 1px solid #555; border-radius: 4px;">
        </div>
      </div>
      <div class="console-panel" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #555;">
        <h4>–ö–æ–Ω—Å–æ–ª—å –ª–æ–≥–æ–≤</h4>
        <div id="console-logs" style="background: #1a1a1a; border: 1px solid #333; border-radius: 4px; padding: 10px; height: 200px; overflow-y: auto; font-family: 'Courier New', monospace; font-size: 0.8em; color: #ccc;">
          <div class="log-entry">–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ...</div>
        </div>
        <button id="clear-logs" style="margin-top: 10px; padding: 5px 10px; background: #666; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em;">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏</button>
      </div>
      <div id="api-status" style="margin-top: 10px; padding: 10px; background: #333; border-radius: 4px; min-height: 20px;"></div>
    </div>
  </div>

  <script type="module" src="game.js"></script>
</body>
</html>